(this["webpackJsonpbattleship-react"]=this["webpackJsonpbattleship-react"]||[]).push([[0],[,,,,,function(e,a,t){e.exports={tile:"GameTile_tile__2V0fi","tile-hover":"GameTile_tile-hover__27pCl","tile-occupied":"GameTile_tile-occupied__2L1Kz","tile-hidden-free":"GameTile_tile-hidden-free__1YNW9","tile-hit":"GameTile_tile-hit__3Blcv","tile-revealed":"GameTile_tile-revealed__3HRYw"}},function(e,a,t){e.exports={"legend-container":"Legend_legend-container__2wkJE","legend-tile":"Legend_legend-tile__2IZZF","legend-text":"Legend_legend-text__2G7dO","legend-entry":"Legend_legend-entry__3pAhb"}},,function(e,a,t){e.exports={"title-text":"RoomSelect_title-text__IneKs","room-input":"RoomSelect_room-input__1E5Ul","room-button":"RoomSelect_room-button__3IM25","input-container":"RoomSelect_input-container__2ToCr"}},function(e,a,t){e.exports={"mode-container":"ModeSelect_mode-container__2Ys0M","mode-button":"ModeSelect_mode-button__2-A9X"}},,,function(e,a,t){e.exports={"game-status":"Gamestatus_game-status__17qnU","status-contaienr":"Gamestatus_status-contaienr__5kGFG","reset-button":"Gamestatus_reset-button__Z03MH"}},,,,,,function(e,a,t){e.exports={"title-text":"Header_title-text__AxQNR"}},function(e,a,t){e.exports={"board-container":"Gameboard_board-container__3_TPw"}},function(e,a,t){e.exports={"gameboard-container":"Game_gameboard-container__NZmrM"}},,,,,,function(e,a,t){},,,,,,function(e,a,t){},function(e,a,t){"use strict";t.r(a),t.d(a,"store",(function(){return ge}));var n,r,o=t(1),c=t.n(o),d=t(10),i=t.n(d),l=(t(26),t(18)),s=t.n(l),p=t(0),b=function(){return Object(p.jsx)("header",{children:Object(p.jsx)("h1",{className:s.a["title-text"],children:"Battleship"})})},y=t(3),u=t(4),O=t(19),j=t.n(O),_=t(5),h=t.n(_),E=t(2),g=0,S=1,m=2,A=3,f=4,N=5,x={PLACING_SHIPS:0,PLAYER1TURN:1,PLAYER2TURN:2,PLAYER1WON:3,PLAYER2WON:4},R={player1:g,player2:g,gameStatus:x.PLACING_SHIPS,player1Score:0,player2Score:0,playerNum:1},v=function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_PLAYER_STATE":return Object(E.a)(Object(E.a)({},a),{},Object(y.a)({},t.payload.player,t.payload.state));case"SET_ONLINE_PLAYER_NUM":return Object(E.a)(Object(E.a)({},a),{},{playerNum:t.payload.player});case"START_GAME":return Object(E.a)(Object(E.a)({},a),{},{player1:1===a.playerNum?m:A,player2:1===a.playerNum?A:m,gameStatus:x["PLAYER"+a.playerNum.toString()+"TURN"]});case"SWAP_TURNS":return Object(E.a)(Object(E.a)({},a),{},{player1:a.player2,player2:a.player1,gameStatus:a.gameStatus===x.PLAYER1TURN?x.PLAYER2TURN:x.PLAYER1TURN});case"RESET_GAME":return Object(E.a)(Object(E.a)({},a),{},{player1:R.player1,player2:R.player2,gameStatus:R.gameStatus});case"GAME_OVER":var n="player1"===t.payload.player?"player2":"player1";return Object(E.a)(Object(E.a)({},a),{},(e={},Object(y.a)(e,n,N),Object(y.a)(e,t.payload.player,f),Object(y.a)(e,n+"Score",a[n+"Score"]+1),Object(y.a)(e,"gameStatus","player1"===n?x.PLAYER1WON:x.PLAYER2WON),e));case"INC_PLAYER_SCORE":return Object(E.a)(Object(E.a)({},a),{},Object(y.a)({},t.payload.player+"Score",a[t.payload.player+"Score"]+1));default:return a}},T=0,L=1,I=2,P=3,C="online",G="player",D="computer",M={state:T,mode:C},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"MODE_SELECTED":return Object(E.a)(Object(E.a)({},e),{},{state:a.payload.mode===C?L:P,mode:a.payload.mode});case"JOINED_ROOM":return Object(E.a)(Object(E.a)({},e),{},{state:I});default:return e}},Y="0",H="R",z="B",w="H",U="X",V=(n={},Object(y.a)(n,z,h.a["tile-occupied"]),Object(y.a)(n,Y,h.a["tile-hidden-free"]),Object(y.a)(n,w,h.a["tile-hover"]),Object(y.a)(n,U,h.a["tile-hit"]),Object(y.a)(n,H,h.a["tile-revealed"]),n),J=function(e){var a=e.socket,t=e.tileIndex,n=e.boardNum,r=e.boardSize,o=e.player,c=e.playerState,d=e.hidden,i=(e.type,e.oppType),l=Object(u.d)((function(e){return e.boards[n][t]})),s=Object(u.c)(),b=function(e){var r=ge.getState();switch(c){case g:var d=r.boards[n+"ShipIndex"],p=r.boards.shipArray[d].length;B(t,r.boards.shipDir,p,r.boards[n])&&(s({type:"CHANGE_ADJ_TILES",payload:{dir:r.boards.shipDir,index:t,length:p,tileContent:z,board:n,isPlacing:!0}}),i===C&&a.current.send(JSON.stringify({event:1,payload:{ROOM_NAME:"test",PLACED_SHIPS:{index:t,dir:r.boards.shipDir,length:p}}}))),(r=ge.getState()).boards[n+"ShipIndex"]>=r.boards.shipArray.length&&(s({type:"CHANGE_PLAYER_STATE",payload:{player:o,state:S}}),(r=ge.getState()).players.player1===r.players.player2&&r.players.player1===S&&s({type:"START_GAME"}));break;case A:if(l===H||l===U||i!==G)return;s({type:"REVEAL_TILE",payload:{board:n,index:t}});var b=ge.getState();F(b.boards[n])?(s({type:"GAME_OVER",payload:{player:o}}),s({type:"REVEAL_BOARD",payload:{board:"board2"}})):s({type:"SWAP_TURNS"});break;default:return}},y=function(){var e=ge.getState();if(c===g){var a=e.boards[n+"ShipIndex"],r=e.boards.shipArray[a].length;B(t,e.boards.shipDir,r,e.boards[n])&&s({type:"CHANGE_ADJ_TILES",payload:{dir:e.boards.shipDir,index:t,length:r,tileContent:w,board:n,isPlacing:!1}})}},O=function(){var e=ge.getState();if(c===g){var a=e.boards[n+"ShipIndex"],r=e.boards.shipArray[a].length;B(t,e.boards.shipDir,r,e.boards[n])&&s({type:"CHANGE_ADJ_TILES",payload:{dir:e.boards.shipDir,index:t,length:r,tileContent:Y,board:n,isPlacing:!1}})}},j=function(e){e.preventDefault(),O(),console.log("Dispatching"),s({type:"TOGGLE_DIR"}),y()};return!0===d&&l!==H&&l!==U?Object(p.jsx)("div",{className:"".concat(h.a.tile," ").concat(V[Y]),onContextMenu:j,onMouseLeave:O,onMouseOver:y,onClick:b,id:"".concat(t),style:{width:"".concat(100/r,"%"),height:"".concat(100/r,"%")}}):Object(p.jsx)("div",{className:"".concat(h.a.tile," ").concat(V[l]),onContextMenu:j,onMouseLeave:O,onMouseOver:y,onClick:b,id:"".concat(t),style:{width:"".concat(100/r,"%"),height:"".concat(100/r,"%")}})},W=function(e){var a=e.socket,t=e.tileIndex,n=e.boardNum,r=e.boardSize,o=e.player,c=e.playerState,d=e.hidden,i=e.type,l=(e.oppType,Object(u.d)((function(e){return e.boards[n][t]}))),s=Object(u.c)(),b=function(){var e=ge.getState(),a="board1"===n?"board2":"board1",t=e.boards[a].map((function(e,a){return e===Y||e===z?a:-1}));t=t.filter((function(e){return-1!==e}));var r=Math.floor(Math.random()*t.length);(s({type:"REVEAL_TILE",payload:{board:a,index:t[r]}}),e=ge.getState(),F(e.boards[a]))?(s({type:"GAME_OVER",payload:{player:"player1"===o?"player2":"player1"}}),s({type:"REVEAL_BOARD",payload:{board:n}})):s({type:"SWAP_TURNS"})},y=function(e){ge.getState();if(c===A&&l!==H&&l!==U){s({type:"REVEAL_TILE",payload:{board:n,index:t}}),i===C&&a.current.send(JSON.stringify({event:2,payload:{index:t}}));var r=ge.getState();F(r.boards[n])?(s({type:"GAME_OVER",payload:{player:o}}),s({type:"REVEAL_BOARD",payload:{board:n}})):(s({type:"SWAP_TURNS"}),i===D&&setTimeout(b,50))}};return!0===d&&l!==H&&l!==U?Object(p.jsx)("div",{className:"".concat(h.a.tile," ").concat(V[Y]),onClick:y,id:"".concat(t),style:{width:"".concat(100/r,"%"),height:"".concat(100/r,"%")}}):Object(p.jsx)("div",{className:"".concat(h.a.tile," ").concat(V[l]),onClick:y,id:"".concat(t),style:{width:"".concat(100/r,"%"),height:"".concat(100/r,"%")}})},B=function(e,a,t,n){for(var r=e;r<e+a*t;r+=a)if("B"===n[r])return!1;return!0},F=function(e){return 0===e.filter((function(e){return"B"===e})).length},X=function(e){var a=e.socket,t=e.playerID,n=e.boardNum,r=e.type,c=e.oppType,d=Object(u.c)(),i=Object(u.d)((function(e){return Array.from(e.boards[n].keys())}),u.b),l=Object(u.d)((function(e){return e.boards[n+"Hidden"]})),s=Object(u.d)((function(e){return e.players[t]})),b=Object(u.d)((function(e){return e.boards.boardSize}));console.log("Rendering"+n),Object(o.useEffect)((function(){r===D&&s===g&&(d({type:"PLACE_RANDOM",payload:{board:n,player:t}}),d({type:"CHANGE_PLAYER_STATE",payload:{player:t,state:S}})),r!==G&&s===g&&d({type:"HIDE_BOARD",payload:{board:n}})}),[s]);return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)("div",{className:j.a["board-container"],children:r===D||r===C?i.map((function(e){return Object(p.jsx)(W,{socket:a,oppType:c,type:r,hidden:l,player:t,playerState:s,boardSize:b,boardNum:n,tileIndex:e},e)})):i.map((function(e){return Object(p.jsx)(J,{socket:a,oppType:c,type:r,hidden:l,player:t,playerState:s,boardSize:b,boardNum:n,tileIndex:e},e)}))})})},Z=t(12),K=t.n(Z),q=(r={},Object(y.a)(r,x.PLACING_SHIPS,"Please Place Your Ships\nRight click to Rotate"),Object(y.a)(r,x.PLAYER1TURN,"You are Attacking"),Object(y.a)(r,x.PLAYER2TURN,"Your Opponent is Attacking"),Object(y.a)(r,x.PLAYER1WON,"You Won"),Object(y.a)(r,x.PLAYER2WON,"Your Opponent Won"),r),Q=function(e){var a=e.socket,t=Object(u.d)((function(e){return e.players.gameStatus})),n=Object(u.d)((function(e){return e.game.mode})),r=Object(u.c)();return Object(p.jsxs)("div",{className:K.a["status-contaienr"],children:[Object(p.jsx)("span",{className:K.a["game-status"],children:q[t]}),(t===x.PLAYER1WON||t===x.PLAYER2WON)&&Object(p.jsx)("button",{className:K.a["reset-button"],onClick:function(){r({type:"RESET_GAME"}),n===C&&a.current.send(JSON.stringify({event:4}))},children:"New Game"})]})},$=t(6),ee=t.n($),ae=function(e){var a=e.socket;return Object(p.jsxs)("div",{className:ee.a["legend-container"],children:[Object(p.jsxs)("div",{className:ee.a["legend-entry"],children:[Object(p.jsx)("div",{className:"".concat(ee.a["legend-tile"]," ").concat(h.a.tile," ").concat(h.a["tile-hidden-free"]),id:"legend"}),Object(p.jsx)("span",{className:ee.a["legend-text"],children:"Hidden Tile"})]}),Object(p.jsxs)("div",{className:ee.a["legend-entry"],children:[Object(p.jsx)("div",{className:"".concat(ee.a["legend-tile"]," ").concat(h.a.tile," ").concat(h.a["tile-revealed"]),id:"legend"}),Object(p.jsx)("span",{className:ee.a["legend-text"],children:"Miss"})]}),Object(p.jsxs)("div",{className:ee.a["legend-entry"],children:[Object(p.jsx)("div",{className:"".concat(ee.a["legend-tile"]," ").concat(h.a.tile," ").concat(h.a["tile-hit"]),id:"legend"}),Object(p.jsx)("span",{className:ee.a["legend-text"],children:"Hit"})]}),Object(p.jsx)(Q,{socket:a})]})},te=t(20),ne=t.n(te),re=function(e){var a=e.socket,t=Object(u.d)((function(e){return e.game.mode}));return Object(p.jsxs)("div",{className:ne.a["gameboard-container"],children:[Object(p.jsx)(X,{socket:a,playerID:"player1",boardNum:"board1",type:G,oppType:t}),Object(p.jsx)(ae,{socket:a}),Object(p.jsx)(X,{socket:a,playerID:"player2",oppType:G,type:t,boardNum:"board2"})]})},oe=t(21),ce=t(8),de=t.n(ce),ie=function(e){var a=e.socket,t=Object(o.useState)(""),n=Object(oe.a)(t,2),r=n[0],c=n[1],d=Object(u.c)();console.log(a);return Object(p.jsxs)("div",{className:de.a["input-container"],children:[Object(p.jsx)("h1",{className:de.a["title-text"],children:"Please Enter A Room Name"}),Object(p.jsx)("input",{onChange:function(e){c(e.target.value)},value:r,className:de.a["room-input"],type:"text"}),Object(p.jsx)("button",{onClick:function(){a.current.send(JSON.stringify({event:0,payload:{ROOM_NAME:r}})),d({type:"JOINED_ROOM"})},className:de.a["room-button"],children:"Join Room"})]})},le=t(9),se=t.n(le),pe=function(){var e=Object(u.c)(),a=function(a){e({type:"MODE_SELECTED",payload:{mode:a.target.value}})};return Object(p.jsxs)("div",{className:se.a["mode-container"],children:[Object(p.jsx)("button",{onClick:a,value:C,className:se.a["mode-button"],children:"Online"}),Object(p.jsx)("button",{onClick:a,value:G,className:se.a["mode-button"],children:"Local"}),Object(p.jsx)("button",{onClick:a,value:D,className:se.a["mode-button"],children:"Computer"})]})},be=function(){var e,a=Object(u.d)((function(e){return e.game.state})),t=Object(o.useRef)(null);return Object(o.useEffect)((function(){a===L&&(t.current=new WebSocket("wss://immense-caverns-86821.herokuapp.com"),t.current.onmessage=function(e){var a;try{a=JSON.parse(e.data)}catch(r){a=e.data}switch(console.log(a),a.event){case"ROOM_JOIN_SUCCESS":ge.dispatch({type:"SET_ONLINE_PLAYER_NUM",payload:{player:a.payload.player}}),console.log("SET ROOM");break;case 1:console.log("Reached"),ge.dispatch({type:"CHANGE_ADJ_TILES",payload:{dir:a.dir,index:a.index,length:a.length,tileContent:z,board:"board2",isPlacing:!0}});var t=ge.getState();t.boards.board2ShipIndex>=t.boards.shipArray.length&&(ge.dispatch({type:"CHANGE_PLAYER_STATE",payload:{player:"player2",state:S}}),(t=ge.getState()).players.player1===t.players.player2&&t.players.player1===S&&ge.dispatch({type:"START_GAME"}));break;case 2:console.log("Received Attack"),ge.dispatch({type:"REVEAL_TILE",payload:{board:"board1",index:a.index}});var n=ge.getState();F(n.boards.board1)?(ge.dispatch({type:"GAME_OVER",payload:{player:"player1"}}),ge.dispatch({type:"REVEAL_BOARD",payload:{board:"board2"}})):ge.dispatch({type:"SWAP_TURNS"});break;case 3:console.log("Received New Game Event"),ge.dispatch({type:"RESET_GAME"})}})}),[a]),(e={},Object(y.a)(e,T,Object(p.jsx)(pe,{})),Object(y.a)(e,L,Object(p.jsx)(ie,{socket:t})),Object(y.a)(e,I,Object(p.jsx)(re,{socket:t})),Object(y.a)(e,P,Object(p.jsx)(re,{socket:t})),e)[a]};t(32);var ye=function(){return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(b,{}),Object(p.jsx)(be,{})]})},ue=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,34)).then((function(a){var t=a.getCLS,n=a.getFID,r=a.getFCP,o=a.getLCP,c=a.getTTFB;t(e),n(e),r(e),o(e),c(e)}))},Oe=t(17),je=t(16),_e={board1:Array(64).fill(Y),board2:Array(64).fill(Y),boardSize:8,shipDir:8,shipArray:[{id:"C",length:5},{id:"B",length:4},{id:"D",length:3},{id:"S",length:3},{id:"P",length:2}],board1ShipIndex:0,board2ShipIndex:0,board1Hidden:!1,board2Hidden:!1},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"CHANGE_TILE":return e[a.payload.board][a.payload.index]===a.payload.tileContent?e:Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board,e[a.payload.board].map((function(e,t){return t===a.payload.index?a.payload.tileContent:e}))));case"CHANGE_SIZE":return e.boardSize===a.payload.size?e:Object(E.a)(Object(E.a)({},e),{},{board1:Array(a.payload.size*a.payload.size).fill(0),board2:Array(a.payload.size*a.payload.size).fill(0),boardSize:a.payload.size});case"CHANGE_ADJ_TILES":var t=a.payload.dir,n=parseInt(a.payload.index/e.boardSize),r=parseInt((a.payload.index+t*(a.payload.length-1))/e.boardSize);if(a.payload.index+t*(a.payload.length-1)>=e[a.payload.board].length)return e;if(1===t&&n!==r)return e;for(var o,c=Object(je.a)(e[a.payload.board]),d=a.payload.index;d<a.payload.index+t*a.payload.length;d+=t)c[d]=a.payload.tileContent;return a.payload.isPlacing?Object(E.a)(Object(E.a)({},e),{},(o={},Object(y.a)(o,a.payload.board,c),Object(y.a)(o,a.payload.board+"ShipIndex",e[a.payload.board+"ShipIndex"]+1),o)):Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board,c));case"TOGGLE_DIR":return Object(E.a)(Object(E.a)({},e),{},{shipDir:1===e.shipDir?e.boardSize:1});case"REVEAL_TILE":return Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board,e[a.payload.board].map((function(e,t){return t===a.payload.index?e===z?U:H:e}))));case"TOGGLE_BOARD_VIS":return Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board+"Hidden",!0!==e[a.payload.board+"Hidden"]));case"HIDE_BOARD":return Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board+"Hidden",!0));case"REVEAL_BOARD":return Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board+"Hidden",!1));case"PLACE_RANDOM":for(var i=Object(je.a)(e[a.payload.board]),l=e[a.payload.board+"ShipIndex"];l<e.shipArray.length;){var s=e.shipArray[l].length,p=Math.floor(Math.random()*e.boardSize*e.boardSize),b=Math.floor(2*Math.random());if(b=1===b?e.boardSize:1,B(p,b,s,i)){var u=parseInt(p/e.boardSize),O=parseInt((p+b*(s-1))/e.boardSize);if(p+b*(s-1)>=e[a.payload.board].length)continue;if(1===b&&u!==O)continue;for(var j=p;j<p+b*s;j+=b)i[j]=z;l++}}return Object(E.a)(Object(E.a)({},e),{},Object(y.a)({},a.payload.board,i));case"RESET_GAME":return _e;default:return e}},Ee=Object(Oe.a)({game:k,boards:he,players:v}),ge=Object(Oe.b)(Ee,void 0,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());console.log(ge.getState()),i.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(u.a,{store:ge,children:Object(p.jsx)(ye,{})})}),document.getElementById("root")),ue()}],[[33,1,2]]]);
//# sourceMappingURL=main.1647b344.chunk.js.map